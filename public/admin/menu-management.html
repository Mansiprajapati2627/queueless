<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu Management - Queueless Admin</title>
    <link rel="stylesheet" href="admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <i class="fas fa-qrcode"></i>
                <h2>Queueless <span class="admin-badge">Admin</span></h2>
            </div>
            <div class="admin-info">
                <div class="admin-avatar">
                    <i class="fas fa-user-shield"></i>
                </div>
                <div class="admin-details">
                    <h4 id="adminName">Administrator</h4>
                    <p id="adminRole">Super Admin</p>
                </div>
            </div>
        </div>

        <nav class="sidebar-nav">
            <a href="index.html" class="nav-item">
                <i class="fas fa-tachometer-alt"></i>
                <span>Dashboard</span>
            </a>
            <a href="orders.html" class="nav-item">
                <i class="fas fa-shopping-cart"></i>
                <span>Orders</span>
            </a>
            <a href="menu-management.html" class="nav-item active">
                <i class="fas fa-utensils"></i>
                <span>Menu Management</span>
            </a>
            <a href="analytics.html" class="nav-item">
                <i class="fas fa-chart-line"></i>
                <span>Analytics</span>
            </a>
            <div class="nav-section">
                <h4>System</h4>
                <a href="customers.html" class="nav-item">
                    <i class="fas fa-users"></i>
                    <span>Customers</span>
                </a>
                <a href="tables.html" class="nav-item">
                    <i class="fas fa-table"></i>
                    <span>Tables</span>
                </a>
                <a href="settings.html" class="nav-item">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </a>
            </div>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <header class="main-header">
            <div class="header-left">
                <h1><i class="fas fa-utensils"></i> Menu Management</h1>
                <p>Manage your restaurant menu items</p>
            </div>
            <div class="header-right">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchMenu" placeholder="Search menu items...">
                </div>
                <button class="btn-primary" onclick="openAddItemModal()">
                    <i class="fas fa-plus"></i> Add New Item
                </button>
            </div>
        </header>

        <!-- Menu Categories -->
        <div class="menu-categories">
            <button class="category-btn active" onclick="filterMenu('all')">All Items</button>
            <button class="category-btn" onclick="filterMenu('veg')">Veg</button>
            <button class="category-btn" onclick="filterMenu('nonveg')">Non-Veg</button>
            <button class="category-btn" onclick="filterMenu('appetizers')">Appetizers</button>
            <button class="category-btn" onclick="filterMenu('maincourse')">Main Course</button>
            <button class="category-btn" onclick="filterMenu('beverages')">Beverages</button>
            <button class="category-btn" onclick="filterMenu('desserts')">Desserts</button>
        </div>

        <!-- Menu Items Grid -->
        <div class="menu-items-grid" id="menuItemsGrid">
            <!-- Menu items will be loaded dynamically -->
        </div>

        <!-- Add/Edit Item Modal -->
        <div id="itemModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="modalTitle">Add New Menu Item</h2>
                    <span class="close" onclick="closeItemModal()">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="itemForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="itemName">Item Name *</label>
                                <input type="text" id="itemName" required>
                            </div>
                            <div class="form-group">
                                <label for="itemPrice">Price (₹) *</label>
                                <input type="number" id="itemPrice" min="0" step="0.01" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="itemCategory">Category *</label>
                                <select id="itemCategory" required>
                                    <option value="veg">Vegetarian</option>
                                    <option value="nonveg">Non-Vegetarian</option>
                                    <option value="appetizers">Appetizers</option>
                                    <option value="maincourse">Main Course</option>
                                    <option value="beverages">Beverages</option>
                                    <option value="desserts">Desserts</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="itemType">Food Type</label>
                                <select id="itemType">
                                    <option value="indian">Indian</option>
                                    <option value="chinese">Chinese</option>
                                    <option value="italian">Italian</option>
                                    <option value="continental">Continental</option>
                                    <option value="fastfood">Fast Food</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="itemDescription">Description</label>
                            <textarea id="itemDescription" rows="3"></textarea>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="itemPrepTime">Preparation Time (minutes)</label>
                                <input type="number" id="itemPrepTime" min="1" value="15">
                            </div>
                            <div class="form-group">
                                <label for="itemAvailability">Availability</label>
                                <select id="itemAvailability">
                                    <option value="available">Available</option>
                                    <option value="unavailable">Unavailable</option>
                                    <option value="limited">Limited Stock</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Special Tags</label>
                            <div class="tags-container">
                                <label class="tag-checkbox">
                                    <input type="checkbox" name="tags" value="spicy">
                                    <span>Spicy</span>
                                </label>
                                <label class="tag-checkbox">
                                    <input type="checkbox" name="tags" value="bestseller">
                                    <span>Best Seller</span>
                                </label>
                                <label class="tag-checkbox">
                                    <input type="checkbox" name="tags" value="chef">
                                    <span>Chef's Special</span>
                                </label>
                                <label class="tag-checkbox">
                                    <input type="checkbox" name="tags" value="healthy">
                                    <span>Healthy</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="itemImage">Image URL</label>
                            <input type="text" id="itemImage" placeholder="https://example.com/image.jpg">
                            <small>Paste image URL or upload later</small>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" onclick="closeItemModal()">Cancel</button>
                    <button class="btn-primary" onclick="saveMenuItem()">Save Item</button>
                </div>
            </div>
        </div>
    </div>

    <script src="admin.js"></script>
    <script>
        // Menu Management Functions
        let menuItems = [];
        let editingItemId = null;

        document.addEventListener('DOMContentLoaded', function() {
            loadMenuItems();
            setupSearch();
        });

        function loadMenuItems() {
            // Load sample menu items
            menuItems = JSON.parse(localStorage.getItem('queueless_menu_items') || '[]');
            
            if (menuItems.length === 0) {
                menuItems = getSampleMenuItems();
                localStorage.setItem('queueless_menu_items', JSON.stringify(menuItems));
            }
            
            renderMenuItems();
        }

        function getSampleMenuItems() {
            return [
                { id: 1, name: "Paneer Tikka", price: 280, category: "veg", type: "indian", description: "Grilled cottage cheese cubes with spices", prepTime: 15, availability: "available", tags: ["bestseller", "chef"], image: "https://images.unsplash.com/photo-1603894584373-5ac82b2ae398?w=400&h=300&fit=crop", sales: 48, rating: 4.5 },
                { id: 2, name: "Chicken Biryani", price: 350, category: "nonveg", type: "indian", description: "Fragrant rice with spicy chicken", prepTime: 25, availability: "available", tags: ["spicy", "bestseller"], image: "https://images.unsplash.com/photo-1563379091339-03246963d9d6?w=400&h=300&fit=crop", sales: 36, rating: 4.8 },
                { id: 3, name: "Cold Coffee", price: 120, category: "beverages", type: "continental", description: "Iced coffee with cream", prepTime: 5, availability: "available", tags: [], image: "https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=400&h=300&fit=crop", sales: 56, rating: 4.3 },
                { id: 4, name: "Chocolate Brownie", price: 150, category: "desserts", type: "continental", description: "Warm chocolate brownie with ice cream", prepTime: 10, availability: "available", tags: ["chef"], image: "https://images.unsplash.com/photo-1570145820259-b5b80c5c8bd6?w=400&h=300&fit=crop", sales: 32, rating: 4.7 },
                { id: 5, name: "Veg Spring Rolls", price: 180, category: "appetizers", type: "chinese", description: "Crispy rolls with vegetable filling", prepTime: 12, availability: "available", tags: [], image: "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=400&h=300&fit=crop", sales: 28, rating: 4.2 },
                { id: 6, name: "Butter Chicken", price: 380, category: "nonveg", type: "indian", description: "Tender chicken in rich tomato gravy", prepTime: 30, availability: "available", tags: ["bestseller", "spicy"], image: "https://images.unsplash.com/photo-1603894584373-5ac82b2ae398?w=400&h=300&fit=crop", sales: 42, rating: 4.9 },
                { id: 7, name: "Margherita Pizza", price: 300, category: "veg", type: "italian", description: "Classic pizza with tomato and cheese", prepTime: 20, availability: "available", tags: [], image: "https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?w=400&h=300&fit=crop", sales: 38, rating: 4.5 },
                { id: 8, name: "Mango Shake", price: 150, category: "beverages", type: "indian", description: "Fresh mango milkshake", prepTime: 6, availability: "limited", tags: ["healthy"], image: "https://images.unsplash.com/photo-1628992682633-bf2d40cb595f?w=400&h=300&fit=crop", sales: 45, rating: 4.6 }
            ];
        }

        function renderMenuItems(filterCategory = 'all') {
            const container = document.getElementById('menuItemsGrid');
            if (!container) return;
            
            let filteredItems = menuItems;
            
            if (filterCategory !== 'all') {
                filteredItems = menuItems.filter(item => item.category === filterCategory);
            }
            
            container.innerHTML = '';
            
            filteredItems.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'menu-item-card';
                itemElement.innerHTML = `
                    <div class="menu-item-header">
                        <span class="item-category ${item.category}">${item.category.toUpperCase()}</span>
                        <span class="item-availability ${item.availability}">${item.availability}</span>
                    </div>
                    <div class="menu-item-image">
                        <img src="${item.image}" alt="${item.name}">
                        ${item.tags.includes('bestseller') ? '<span class="item-badge bestseller">BEST</span>' : ''}
                        ${item.tags.includes('chef') ? '<span class="item-badge chefspecial">CHEF</span>' : ''}
                    </div>
                    <div class="menu-item-details">
                        <h3>${item.name}</h3>
                        <p class="item-description">${item.description}</p>
                        <div class="item-meta">
                            <span><i class="fas fa-clock"></i> ${item.prepTime} min</span>
                            <span><i class="fas fa-star"></i> ${item.rating}</span>
                            <span><i class="fas fa-shopping-cart"></i> ${item.sales}</span>
                        </div>
                        <div class="item-tags">
                            ${item.tags.map(tag => `<span class="tag tag-${tag}">${tag}</span>`).join('')}
                        </div>
                        <div class="item-footer">
                            <span class="item-price">₹${item.price}</span>
                            <div class="item-actions">
                                <button class="btn-edit" onclick="editMenuItem(${item.id})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn-delete" onclick="deleteMenuItem(${item.id})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(itemElement);
            });
        }

        function filterMenu(category) {
            // Update active button
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            renderMenuItems(category);
        }

        function setupSearch() {
            const searchInput = document.getElementById('searchMenu');
            if (searchInput) {
                searchInput.addEventListener('input', function(e) {
                    const searchTerm = e.target.value.toLowerCase();
                    const container = document.getElementById('menuItemsGrid');
                    
                    if (!container) return;
                    
                    container.innerHTML = '';
                    
                    const filteredItems = menuItems.filter(item => 
                        item.name.toLowerCase().includes(searchTerm) || 
                        item.description.toLowerCase().includes(searchTerm)
                    );
                    
                    filteredItems.forEach(item => {
                        // Similar item element creation as in renderMenuItems
                        const itemElement = document.createElement('div');
                        itemElement.className = 'menu-item-card';
                        itemElement.innerHTML = `
                            <div class="menu-item-header">
                                <span class="item-category ${item.category}">${item.category.toUpperCase()}</span>
                                <span class="item-availability ${item.availability}">${item.availability}</span>
                            </div>
                            <div class="menu-item-image">
                                <img src="${item.image}" alt="${item.name}">
                            </div>
                            <div class="menu-item-details">
                                <h3>${item.name}</h3>
                                <p class="item-description">${item.description}</p>
                                <div class="item-footer">
                                    <span class="item-price">₹${item.price}</span>
                                    <div class="item-actions">
                                        <button class="btn-edit" onclick="editMenuItem(${item.id})">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn-delete" onclick="deleteMenuItem(${item.id})">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `;
                        container.appendChild(itemElement);
                    });
                });
            }
        }

        function openAddItemModal() {
            editingItemId = null;
            document.getElementById('modalTitle').textContent = 'Add New Menu Item';
            document.getElementById('itemForm').reset();
            document.getElementById('itemModal').style.display = 'flex';
        }

        function editMenuItem(itemId) {
            const item = menuItems.find(i => i.id === itemId);
            if (!item) return;
            
            editingItemId = itemId;
            document.getElementById('modalTitle').textContent = 'Edit Menu Item';
            
            // Fill form with item data
            document.getElementById('itemName').value = item.name;
            document.getElementById('itemPrice').value = item.price;
            document.getElementById('itemCategory').value = item.category;
            document.getElementById('itemType').value = item.type || 'indian';
            document.getElementById('itemDescription').value = item.description;
            document.getElementById('itemPrepTime').value = item.prepTime;
            document.getElementById('itemAvailability').value = item.availability;
            document.getElementById('itemImage').value = item.image;
            
            // Check tags
            document.querySelectorAll('input[name="tags"]').forEach(checkbox => {
                checkbox.checked = item.tags.includes(checkbox.value);
            });
            
            document.getElementById('itemModal').style.display = 'flex';
        }

        function saveMenuItem() {
            const form = document.getElementById('itemForm');
            if (!form.checkValidity()) {
                alert('Please fill all required fields');
                return;
            }
            
            const tags = [];
            document.querySelectorAll('input[name="tags"]:checked').forEach(checkbox => {
                tags.push(checkbox.value);
            });
            
            const newItem = {
                id: editingItemId || menuItems.length + 1,
                name: document.getElementById('itemName').value,
                price: parseFloat(document.getElementById('itemPrice').value),
                category: document.getElementById('itemCategory').value,
                type: document.getElementById('itemType').value,
                description: document.getElementById('itemDescription').value,
                prepTime: parseInt(document.getElementById('itemPrepTime').value),
                availability: document.getElementById('itemAvailability').value,
                tags: tags,
                image: document.getElementById('itemImage').value || 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=400&h=300&fit=crop',
                sales: 0,
                rating: 4.0
            };
            
            if (editingItemId) {
                // Update existing item
                const index = menuItems.findIndex(i => i.id === editingItemId);
                if (index !== -1) {
                    // Keep existing sales and rating
                    newItem.sales = menuItems[index].sales;
                    newItem.rating = menuItems[index].rating;
                    menuItems[index] = newItem;
                }
            } else {
                // Add new item
                menuItems.push(newItem);
            }
            
            localStorage.setItem('queueless_menu_items', JSON.stringify(menuItems));
            closeItemModal();
            renderMenuItems();
            
            alert(editingItemId ? 'Item updated successfully!' : 'Item added successfully!');
        }

        function deleteMenuItem(itemId) {
            if (confirm('Are you sure you want to delete this item?')) {
                menuItems = menuItems.filter(item => item.id !== itemId);
                localStorage.setItem('queueless_menu_items', JSON.stringify(menuItems));
                renderMenuItems();
                alert('Item deleted successfully!');
            }
        }

        function closeItemModal() {
            document.getElementById('itemModal').style.display = 'none';
            document.getElementById('itemForm').reset();
        }
    </script>
</body>
</html>